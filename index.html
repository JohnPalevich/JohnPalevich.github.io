<html>
	<script>
		function validateForm(){
			var xLower = parseFloat(document.getElementById("xLower").value);
			var xHigher = parseFloat(document.getElementById("xHigher").value);
			var derivative = document.getElementById("derivative").value;
			var steps = parseFloat(document.getElementById("steps").value);
			var graphSteps = parseFloat(document.getElementById("graphSteps").value);
			var myCanvas = document.getElementById("myCanvas");
			var translateX = parseFloat(document.getElementById("translateX").value);
			var translateY = parseFloat(document.getElementById("translateY").value);
			var scaleX = parseFloat(document.getElementById("scaleX").value);
			var scaleY = parseFloat(document.getElementById("scaleY").value);
			if(derivative == ""){
				alert("something must be filled out");
				return false;
			}
			var ctx = myCanvas.getContext("2d");
			ctx.save();
			ctx.translate(translateX,translateY);
			ctx.scale(scaleX, scaleY);
			var fn = makeFunction(derivative);
			var integral = numIntegrate(fn, xLower, xHigher, steps);
			document.getElementById("answer").innerHTML = integral;
			drawAxes(ctx);
			graph(fn, xLower, xHigher, graphSteps, ctx);
			ctx.restore();
		}
		function setDefaults(){
			document.getElementById("xLower").defaultValue = "0";
			document.getElementById("xHigher").defaultValue = "10";
			document.getElementById("derivative").defaultValue = "Math.sin(x)";
			document.getElementById("steps").defaultValue = "1000000";
			document.getElementById("graphSteps").defaultValue = "300";
			document.getElementById("translateX").defaultValue = "0";
			document.getElementById("translateY").defaultValue = "150";
			document.getElementById("scaleX").defaultValue = "30";
			document.getElementById("scaleY").defaultValue = "-30";
		}
		function makeFunction(s){
			return new Function("x", "{return "+s+";}");
		}
		function numIntegrate(func, xLower, xHigher, steps){
			var step = (xHigher-xLower)/steps;
			var sum = 0;
			for(var i = xLower; i < xHigher; i+=step){
				sum+= func(i) * step;
			}
			return sum;
		}
		function drawAxes(ctx){
			ctx.save();
			ctx.strokeStyle = "#0000FF";
			ctx.lineWidth = 1/30;
			ctx.moveTo(0,0);
			ctx.lineTo(300, 0);
			ctx.moveTo(0,150);
			ctx.lineTo(0,-150);
			ctx.stroke();
			ctx.restore();
		}
		function graph(func,xLower,xHigher,steps, ctx){
			var step = (xHigher -xLower)/steps;
			ctx.lineWidth = 1/30;
			ctx.moveTo(xLower, func(xLower));
			for(var i = xLower; i < xHigher; i+=step){
				ctx.lineTo(i, func(i));
			} 
			ctx.stroke();
		}
		function clearCanvas(){
			var myCanvas = document.getElementById("myCanvas");
			var ctx = myCanvas.getContext("2d");
			ctx.resetTransform();
			ctx.clearRect(0, 0, myCanvas.width, myCanvas.height);
		}
	</script>
	<body onload="setDefaults()">
		xLower: <input type ="text" id="xLower">
		<p/>
		xHigher: <input type ="text" id="xHigher">
		<p/>
		function: ∫ <input type ="text" id="derivative"> dx
		<p/>
		steps: δ = <input type ="text" id="steps">
		<p/>
		graphSteps: δ = <input type ="text" id="graphSteps">
		<p/>
		translateX: <input type ="text" id="translateX"> 
		translateY: <input type ="text" id="translateY">
		<p/>
		scaleX: <input type="text" id="scaleX">
		scaleY: <input type="text" id="scaleY">
		<button onClick=validateForm() type="submit">
			Submit
		</button>
		<p/>
		Answer:
		<div id="answer">
		</div>
		<p/>
		<canvas id="myCanvas" width="300" height="300"/>
		<p/>
		<button onClick=clearCanvas() type="submit">
			Clear
		</button>
		<p/>
		By John Palevich
		<p/>
		For AP Calculus at Bellevue High School
	</body>
</html>
